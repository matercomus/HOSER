road_network_encoder_config:
  road_id_emb_dim: 64
  len_emb_dim: 16
  type_emb_dim: 16
  lon_emb_dim: 16
  lat_emb_dim: 16
  intersection_emb_dim: 128
  zone_id_emb_dim: 128
  # determined at runtime
  road_id_num_embeddings:
  # determined at runtime
  type_num_embeddings:
  zone_id_num_embeddings: 300

# determined at runtime
road_network_encoder_feature:
  road_attr:
    len:
    type:
    lon:
    lat:
  road_edge_index:
  intersection_attr:
  zone_edge_index:
  zone_edge_weight:

trajectory_encoder_config:
  hidden_dim: 128
  num_heads: 2
  num_layers: 2
  dropout: 0.0
  max_len: 1024
  grad_checkpoint: true

navigator_config:
  hidden_dim: 128

optimizer_config:
  max_epoch: 25
  batch_size: 20
  accum_steps: 3
  learning_rate: 0.001
  weight_decay: 0.1
  warmup_ratio: 0.1
  max_norm: 1.0

# Distillation settings (used by train_with_distill.py)
distill:
  enable: true
  repo: /home/matt/Dev/LMTAD
  ckpt: /home/matt/Dev/LMTAD/code/results/LMTAD/beijing_hoser/ckpt_best_weights_only.pt
  window: 48
  lambda: 0.01
  temperature: 2.0
  grid_size: 0.001
  downsample: 4

# Optional: point directly to external HOSER-format data dir
data_dir: /mnt/i/Matt-Backups/BJUT-BJ-TAXI-DATASET-Backups/HOSER/2025-09-03-gps-gotrackit/output/run_20250908_195312/hoser_format

# Dataloader performance knobs
dataloader:
  num_workers: 32
  pin_memory: true
  prefetch_factor: 6
  persistent_workers: true

# Training performance knobs
training:
  allow_tf32: true
  cudnn_benchmark: true
  torch_compile: true
  disable_cudagraphs: true
