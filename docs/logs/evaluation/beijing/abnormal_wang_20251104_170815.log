2025-11-04 17:08:46,737 - INFO - Running only phases: {'abnormal'}
2025-11-04 17:08:46,772 - INFO - Working directory: /home/matt/Dev/HOSER/hoser-distill-optuna-6
2025-11-04 17:08:46,772 - INFO - Validating pipeline configuration...
2025-11-04 17:08:46,781 - INFO - âœ“ Cross-dataset evaluation enabled: BJUT_Beijing
2025-11-04 17:08:46,830 - INFO - Configuration validation passed
2025-11-04 17:08:46,899 - INFO - Starting HOSER Distillation Evaluation Pipeline
2025-11-04 17:08:46,901 - INFO - Configuration: {'eval_dir': PosixPath('/home/matt/Dev/HOSER/hoser-distill-optuna-6'), 'wandb_project': 'hoser-distill-optuna-6', 'dataset': 'Beijing', 'cuda_device': 0, 'num_gene': 5000, 'seed': 42, 'models': [], 'od_sources': ['train', 'test'], 'phases': {'abnormal'}, 'force': False, 'enable_wandb': True, 'verbose': False, 'beam_width': 4, 'grid_size': 0.001, 'edr_eps': 100.0, 'background_sync': True, 'run_scenarios': False, 'scenarios_config': None, 'cross_dataset_eval': '../data/BJUT_Beijing', 'cross_dataset_name': 'BJUT_Beijing', 'run_abnormal_detection': True, 'abnormal_config': 'config/abnormal_detection_statistical.yaml'}
2025-11-04 17:08:46,901 - INFO - Enabled phases: ['abnormal']
2025-11-04 17:08:46,903 - INFO - Detected models: ['distilled', 'distilled_seed44', 'vanilla']
2025-11-04 17:08:46,903 - INFO - Models to process: ['distilled', 'distilled_seed44', 'vanilla']
2025-11-04 17:08:46,903 - INFO - OD sources: ['train', 'test']
2025-11-04 17:08:46,904 - INFO - â­ï¸  Skipping phase: generation
2025-11-04 17:08:46,905 - INFO - â­ï¸  Skipping phase: base_eval
2025-11-04 17:08:46,906 - INFO - â­ï¸  Skipping phase: cross_dataset
2025-11-04 17:08:46,906 - INFO - â­ï¸  Skipping phase: road_network_translate
2025-11-04 17:08:46,907 - INFO - 
======================================================================
2025-11-04 17:08:46,907 - INFO - ğŸš€ Running phase: abnormal
2025-11-04 17:08:46,907 - INFO - ======================================================================
2025-11-04 17:08:46,908 - INFO - ğŸ” Running abnormal detection...
2025-11-04 17:08:46,908 - INFO - 
ğŸ” Starting abnormal trajectory detection analysis...
2025-11-04 17:08:46,911 - INFO - Will analyze 2 dataset(s): ['Beijing', 'BJUT_Beijing']
2025-11-04 17:08:46,911 - INFO - 
======================================================================
2025-11-04 17:08:46,912 - INFO - ğŸ“Š Analyzing dataset: Beijing (main)
2025-11-04 17:08:46,912 - INFO - ======================================================================
2025-11-04 17:08:46,912 - INFO - 
ğŸ” Step 1: Detecting abnormal trajectories in real data...
2025-11-04 17:08:46,942 - INFO - 
  ğŸ“‚ Processing train data...
2025-11-04 17:08:46,942 - INFO -     ğŸ” Detecting abnormal trajectories in REAL data...
2025-11-04 17:08:46,942 - INFO - ğŸ” Starting abnormal trajectory analysis...
2025-11-04 17:08:46,942 - INFO - ğŸ“‚ Dataset: Beijing
2025-11-04 17:08:46,942 - INFO - ğŸ“‚ Input file: /home/matt/Dev/HOSER/data/Beijing/train.csv
2025-11-04 17:08:46,942 - INFO - âš™ï¸  Config: config/abnormal_detection_statistical.yaml
2025-11-04 17:08:46,949 - INFO - ğŸ’¾ Output directory: abnormal/Beijing/train/real_data
2025-11-04 17:08:46,955 - INFO - ğŸ” Detection method: wang_statistical
2025-11-04 17:08:46,955 - INFO - âš™ï¸  Loading configuration...
2025-11-04 17:08:46,956 - INFO - ğŸ“‚ Loading road network...
2025-11-04 17:08:49,059 - INFO - ğŸ“‚ Loading real trajectories...
2025-11-04 17:11:21,912 - INFO - âœ… Loaded 629380 trajectories
2025-11-04 17:11:21,913 - INFO - ğŸ“Š Using Wang et al. 2018 statistical detection
2025-11-04 17:11:21,914 - WARNING - âš ï¸  Baselines not found: baselines/baselines_beijing.json
2025-11-04 17:11:21,914 - WARNING -    To use statistical detection, run: uv run python tools/compute_trajectory_baselines.py --dataset Beijing
2025-11-04 17:11:21,915 - ERROR - âŒ Baselines required for statistical detection
2025-11-04 17:11:21,915 - ERROR -   âŒ Abnormal analysis failed for train: Baseline statistics not found for Beijing. Run: uv run python tools/compute_trajectory_baselines.py
Traceback (most recent call last):
  File "/home/matt/Dev/HOSER/hoser-distill-optuna-6/../python_pipeline.py", line 1114, in _analyze_dataset_abnormalities
    real_results = run_abnormal_analysis(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/matt/Dev/HOSER/hoser-distill-optuna-6/../tools/analyze_abnormal.py", line 453, in run_abnormal_analysis
    raise FileNotFoundError(
FileNotFoundError: Baseline statistics not found for Beijing. Run: uv run python tools/compute_trajectory_baselines.py
2025-11-04 17:11:21,921 - INFO - 
  ğŸ“‚ Processing test data...
2025-11-04 17:11:21,921 - INFO -     ğŸ” Detecting abnormal trajectories in REAL data...
2025-11-04 17:11:21,921 - INFO - ğŸ” Starting abnormal trajectory analysis...
2025-11-04 17:11:21,922 - INFO - ğŸ“‚ Dataset: Beijing
2025-11-04 17:11:21,922 - INFO - ğŸ“‚ Input file: /home/matt/Dev/HOSER/data/Beijing/test.csv
2025-11-04 17:11:21,922 - INFO - âš™ï¸  Config: config/abnormal_detection_statistical.yaml
2025-11-04 17:11:21,933 - INFO - ğŸ’¾ Output directory: abnormal/Beijing/test/real_data
2025-11-04 17:11:21,939 - INFO - ğŸ” Detection method: wang_statistical
2025-11-04 17:11:21,940 - INFO - âš™ï¸  Loading configuration...
2025-11-04 17:11:21,940 - INFO - ğŸ“‚ Loading road network...
2025-11-04 17:11:21,987 - INFO - ğŸ“‚ Loading real trajectories...
2025-11-04 17:12:05,764 - INFO - âœ… Loaded 179823 trajectories
2025-11-04 17:12:05,764 - INFO - ğŸ“Š Using Wang et al. 2018 statistical detection
2025-11-04 17:12:05,764 - WARNING - âš ï¸  Baselines not found: baselines/baselines_beijing.json
2025-11-04 17:12:05,765 - WARNING -    To use statistical detection, run: uv run python tools/compute_trajectory_baselines.py --dataset Beijing
2025-11-04 17:12:05,765 - ERROR - âŒ Baselines required for statistical detection
2025-11-04 17:12:05,765 - ERROR -   âŒ Abnormal analysis failed for test: Baseline statistics not found for Beijing. Run: uv run python tools/compute_trajectory_baselines.py
Traceback (most recent call last):
  File "/home/matt/Dev/HOSER/hoser-distill-optuna-6/../python_pipeline.py", line 1114, in _analyze_dataset_abnormalities
    real_results = run_abnormal_analysis(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/matt/Dev/HOSER/hoser-distill-optuna-6/../tools/analyze_abnormal.py", line 453, in run_abnormal_analysis
    raise FileNotFoundError(
FileNotFoundError: Baseline statistics not found for Beijing. Run: uv run python tools/compute_trajectory_baselines.py
2025-11-04 17:12:05,766 - INFO - 
âœ… Abnormal analysis complete for Beijing! Results in abnormal/Beijing/
2025-11-04 17:12:05,767 - INFO - 
======================================================================
2025-11-04 17:12:05,767 - INFO - ğŸ“Š Analyzing dataset: BJUT_Beijing (cross-dataset)
2025-11-04 17:12:05,767 - INFO - ======================================================================
2025-11-04 17:12:05,767 - INFO - 
ğŸ” Step 1: Detecting abnormal trajectories in real data...
2025-11-04 17:12:05,769 - INFO - 
  ğŸ“‚ Processing train data...
2025-11-04 17:12:05,770 - INFO -     ğŸ” Detecting abnormal trajectories in REAL data...
2025-11-04 17:12:05,771 - INFO - ğŸ” Starting abnormal trajectory analysis...
2025-11-04 17:12:05,771 - INFO - ğŸ“‚ Dataset: BJUT_Beijing
2025-11-04 17:12:05,771 - INFO - ğŸ“‚ Input file: /home/matt/Dev/HOSER/hoser-distill-optuna-6/../data/BJUT_Beijing/train.csv
2025-11-04 17:12:05,771 - INFO - âš™ï¸  Config: config/abnormal_detection_statistical.yaml
2025-11-04 17:12:05,791 - INFO - ğŸ’¾ Output directory: abnormal/BJUT_Beijing/train/real_data
2025-11-04 17:12:05,802 - INFO - ğŸ” Detection method: wang_statistical
2025-11-04 17:12:05,802 - INFO - âš™ï¸  Loading configuration...
2025-11-04 17:12:05,806 - INFO - ğŸ“‚ Loading road network...
2025-11-04 17:12:09,912 - INFO - ğŸ“‚ Loading real trajectories...
2025-11-04 17:12:16,488 - INFO - âœ… Loaded 27897 trajectories
2025-11-04 17:12:16,488 - INFO - ğŸ“Š Using Wang et al. 2018 statistical detection
2025-11-04 17:12:16,489 - WARNING - âš ï¸  Baselines not found: baselines/baselines_bjut_beijing.json
2025-11-04 17:12:16,489 - WARNING -    To use statistical detection, run: uv run python tools/compute_trajectory_baselines.py --dataset BJUT_Beijing
2025-11-04 17:12:16,489 - ERROR - âŒ Baselines required for statistical detection
2025-11-04 17:12:16,489 - ERROR -   âŒ Abnormal analysis failed for train: Baseline statistics not found for BJUT_Beijing. Run: uv run python tools/compute_trajectory_baselines.py
Traceback (most recent call last):
  File "/home/matt/Dev/HOSER/hoser-distill-optuna-6/../python_pipeline.py", line 1114, in _analyze_dataset_abnormalities
    real_results = run_abnormal_analysis(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/matt/Dev/HOSER/hoser-distill-optuna-6/../tools/analyze_abnormal.py", line 453, in run_abnormal_analysis
    raise FileNotFoundError(
FileNotFoundError: Baseline statistics not found for BJUT_Beijing. Run: uv run python tools/compute_trajectory_baselines.py
2025-11-04 17:12:16,496 - INFO - 
  ğŸ“‚ Processing test data...
2025-11-04 17:12:16,496 - INFO -     ğŸ” Detecting abnormal trajectories in REAL data...
2025-11-04 17:12:16,496 - INFO - ğŸ” Starting abnormal trajectory analysis...
2025-11-04 17:12:16,497 - INFO - ğŸ“‚ Dataset: BJUT_Beijing
2025-11-04 17:12:16,497 - INFO - ğŸ“‚ Input file: /home/matt/Dev/HOSER/hoser-distill-optuna-6/../data/BJUT_Beijing/test.csv
2025-11-04 17:12:16,497 - INFO - âš™ï¸  Config: config/abnormal_detection_statistical.yaml
2025-11-04 17:12:16,518 - INFO - ğŸ’¾ Output directory: abnormal/BJUT_Beijing/test/real_data
2025-11-04 17:12:16,531 - INFO - ğŸ” Detection method: wang_statistical
2025-11-04 17:12:16,531 - INFO - âš™ï¸  Loading configuration...
2025-11-04 17:12:16,534 - INFO - ğŸ“‚ Loading road network...
2025-11-04 17:12:16,635 - INFO - ğŸ“‚ Loading real trajectories...
2025-11-04 17:12:17,972 - INFO - âœ… Loaded 5979 trajectories
2025-11-04 17:12:17,972 - INFO - ğŸ“Š Using Wang et al. 2018 statistical detection
2025-11-04 17:12:17,973 - WARNING - âš ï¸  Baselines not found: baselines/baselines_bjut_beijing.json
2025-11-04 17:12:17,973 - WARNING -    To use statistical detection, run: uv run python tools/compute_trajectory_baselines.py --dataset BJUT_Beijing
2025-11-04 17:12:17,973 - ERROR - âŒ Baselines required for statistical detection
2025-11-04 17:12:17,973 - ERROR -   âŒ Abnormal analysis failed for test: Baseline statistics not found for BJUT_Beijing. Run: uv run python tools/compute_trajectory_baselines.py
Traceback (most recent call last):
  File "/home/matt/Dev/HOSER/hoser-distill-optuna-6/../python_pipeline.py", line 1114, in _analyze_dataset_abnormalities
    real_results = run_abnormal_analysis(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/matt/Dev/HOSER/hoser-distill-optuna-6/../tools/analyze_abnormal.py", line 453, in run_abnormal_analysis
    raise FileNotFoundError(
FileNotFoundError: Baseline statistics not found for BJUT_Beijing. Run: uv run python tools/compute_trajectory_baselines.py
2025-11-04 17:12:17,976 - INFO - 
âœ… Abnormal analysis complete for BJUT_Beijing! Results in abnormal/BJUT_Beijing/
2025-11-04 17:12:17,976 - INFO - âœ… Phase abnormal completed
2025-11-04 17:12:17,976 - INFO - â­ï¸  Skipping phase: abnormal_od_extract
2025-11-04 17:12:17,976 - INFO - â­ï¸  Skipping phase: abnormal_od_generate
2025-11-04 17:12:17,976 - INFO - â­ï¸  Skipping phase: abnormal_od_evaluate
2025-11-04 17:12:17,976 - INFO - â­ï¸  Skipping phase: scenarios
2025-11-04 17:12:17,976 - INFO - 
âœ… Pipeline completed successfully!
2025-11-04 17:12:17,977 - INFO - âœ… Pipeline completed successfully!
ğŸ“‚ Loading road network...
ğŸ“ Calculating road centroids for 40,060 roads...
âœ… Road network loaded: 40,060 valid roads
ğŸ“‚ Loading trajectories from /home/matt/Dev/HOSER/data/Beijing/train.csv...
ğŸ”„ Parsing 629,380 trajectories...
âœ… Loaded 629,380 valid trajectories (dropped 0)
ğŸ“‚ Using cached road network...
ğŸ“‚ Loading trajectories from /home/matt/Dev/HOSER/data/Beijing/test.csv...
ğŸ”„ Parsing 179,823 trajectories...
âœ… Loaded 179,823 valid trajectories (dropped 0)
ğŸ“‚ Loading road network...
ğŸ“ Calculating road centroids for 87,481 roads...
âœ… Road network loaded: 87,481 valid roads
ğŸ“‚ Loading trajectories from /home/matt/Dev/HOSER/hoser-distill-optuna-6/../data/BJUT_Beijing/train.csv...
ğŸ”„ Parsing 27,897 trajectories...
âœ… Loaded 27,897 valid trajectories (dropped 0)
ğŸ“‚ Using cached road network...
ğŸ“‚ Loading trajectories from /home/matt/Dev/HOSER/hoser-distill-optuna-6/../data/BJUT_Beijing/test.csv...
ğŸ”„ Parsing 5,979 trajectories...
âœ… Loaded 5,979 valid trajectories (dropped 0)
