2025-11-03 17:42:57,155 - INFO - Running only phases: {'abnormal'}
2025-11-03 17:42:57,170 - INFO - Working directory: /home/matt/Dev/HOSER/hoser-distill-optuna-6
2025-11-03 17:42:57,170 - INFO - Validating pipeline configuration...
2025-11-03 17:42:57,179 - INFO - âœ“ Cross-dataset evaluation enabled: BJUT_Beijing
2025-11-03 17:42:57,255 - INFO - Configuration validation passed
2025-11-03 17:42:57,315 - INFO - Starting HOSER Distillation Evaluation Pipeline
2025-11-03 17:42:57,316 - INFO - Configuration: {'eval_dir': PosixPath('/home/matt/Dev/HOSER/hoser-distill-optuna-6'), 'wandb_project': 'hoser-distill-optuna-6', 'dataset': 'Beijing', 'cuda_device': 0, 'num_gene': 5000, 'seed': 42, 'models': [], 'od_sources': ['train', 'test'], 'phases': {'abnormal'}, 'force': False, 'enable_wandb': True, 'verbose': False, 'beam_width': 4, 'grid_size': 0.001, 'edr_eps': 100.0, 'background_sync': True, 'run_scenarios': False, 'scenarios_config': None, 'cross_dataset_eval': '../data/BJUT_Beijing', 'cross_dataset_name': 'BJUT_Beijing', 'run_abnormal_detection': True, 'abnormal_config': 'config/abnormal_detection.yaml'}
2025-11-03 17:42:57,317 - INFO - Enabled phases: ['abnormal']
2025-11-03 17:42:57,318 - INFO - Detected models: ['distilled', 'distilled_seed44', 'vanilla']
2025-11-03 17:42:57,319 - INFO - Models to process: ['distilled', 'distilled_seed44', 'vanilla']
2025-11-03 17:42:57,319 - INFO - OD sources: ['train', 'test']
2025-11-03 17:42:57,319 - INFO - â­ï¸  Skipping phase: generation
2025-11-03 17:42:57,320 - INFO - â­ï¸  Skipping phase: base_eval
2025-11-03 17:42:57,320 - INFO - â­ï¸  Skipping phase: cross_dataset
2025-11-03 17:42:57,320 - INFO - 
======================================================================
2025-11-03 17:42:57,321 - INFO - ğŸš€ Running phase: abnormal
2025-11-03 17:42:57,321 - INFO - ======================================================================
2025-11-03 17:42:57,321 - INFO - ğŸ” Running abnormal detection...
2025-11-03 17:42:57,363 - INFO - 
ğŸ” Starting abnormal trajectory detection analysis...
2025-11-03 17:42:57,363 - INFO - Analyzing dataset: BJUT_Beijing
2025-11-03 17:42:57,363 - INFO - 
ğŸ” Step 1: Detecting abnormal trajectories in real data...
2025-11-03 17:42:57,366 - INFO -   Processing train data...
2025-11-03 17:42:57,366 - INFO - ğŸ” Starting abnormal trajectory analysis...
2025-11-03 17:42:57,366 - INFO - ğŸ“‚ Dataset: BJUT_Beijing
2025-11-03 17:42:57,366 - INFO - ğŸ“‚ Real data: /home/matt/Dev/HOSER/hoser-distill-optuna-6/../data/BJUT_Beijing/train.csv
2025-11-03 17:42:57,366 - INFO - âš™ï¸  Config: config/abnormal_detection.yaml
2025-11-03 17:42:57,366 - INFO - ğŸ’¾ Output directory: abnormal/BJUT_Beijing/train/detection
2025-11-03 17:42:57,366 - INFO - âš™ï¸  Loading configuration...
2025-11-03 17:42:57,374 - INFO - ğŸ“‚ Loading road network...
2025-11-03 17:43:02,181 - INFO - ğŸ“‚ Loading real trajectories...
2025-11-03 17:43:08,905 - INFO - âœ… Loaded 27897 trajectories
2025-11-03 17:43:09,689 - INFO - ğŸ“Š Total trajectory points: 715,289
2025-11-03 17:43:09,689 - INFO - ğŸ”§ Initializing abnormal trajectory detector...
2025-11-03 17:43:14,059 - INFO - ğŸ” Running abnormality detection...
2025-11-03 17:43:14,059 - INFO - Analyzing 715289 trajectories for abnormalities...
2025-11-03 17:43:25,545 - INFO - Detection complete. Found abnormalities:
2025-11-03 17:43:25,545 - INFO -   speeding: 0 (0.00%)
2025-11-03 17:43:25,545 - INFO -   detour: 0 (0.00%)
2025-11-03 17:43:25,545 - INFO -   suspicious_stops: 0 (0.00%)
2025-11-03 17:43:25,545 - INFO -   circuitous: 0 (0.00%)
2025-11-03 17:43:25,545 - INFO -   unusual_duration: 0 (0.00%)
2025-11-03 17:43:25,545 - INFO - ğŸ’¾ Saving detection results...
2025-11-03 17:43:25,546 - INFO - âœ… Saved detection results to abnormal/BJUT_Beijing/train/detection/detection_results.json
2025-11-03 17:43:25,546 - INFO - âœ… Saved statistics to abnormal/BJUT_Beijing/train/detection/statistics_by_category.json
2025-11-03 17:43:25,546 - INFO - ğŸ’¾ Saving trajectory samples...
2025-11-03 17:43:25,547 - INFO - 
============================================================
2025-11-03 17:43:25,547 - INFO - ğŸ“‹ ABNORMAL TRAJECTORY DETECTION SUMMARY
2025-11-03 17:43:25,548 - INFO - ============================================================
2025-11-03 17:43:25,548 - INFO - Dataset: BJUT_Beijing
2025-11-03 17:43:25,548 - INFO - Total trajectories analyzed: 27,897
2025-11-03 17:43:25,548 - INFO - 
Abnormalities detected:
2025-11-03 17:43:25,548 - INFO -   â€¢ speeding: 0 (0.00%)
2025-11-03 17:43:25,549 - INFO -   â€¢ detour: 0 (0.00%)
2025-11-03 17:43:25,549 - INFO -   â€¢ suspicious_stops: 0 (0.00%)
2025-11-03 17:43:25,549 - INFO -   â€¢ circuitous: 0 (0.00%)
2025-11-03 17:43:25,549 - INFO -   â€¢ unusual_duration: 0 (0.00%)
2025-11-03 17:43:25,549 - INFO - ============================================================
2025-11-03 17:43:25,549 - INFO - ğŸ’¾ Results saved to: abnormal/BJUT_Beijing/train/detection
2025-11-03 17:43:25,549 - INFO - âœ… Analysis complete!
2025-11-03 17:43:25,638 - INFO -   âœ… Detection complete: 5 abnormal categories found
2025-11-03 17:43:25,638 - INFO - 
ğŸ“ˆ Step 2: Evaluating models on abnormal trajectories (train)...
2025-11-03 17:43:25,638 - INFO -   No abnormal trajectories found, skipping model evaluation
2025-11-03 17:43:25,640 - INFO -   Processing test data...
2025-11-03 17:43:25,640 - INFO - ğŸ” Starting abnormal trajectory analysis...
2025-11-03 17:43:25,640 - INFO - ğŸ“‚ Dataset: BJUT_Beijing
2025-11-03 17:43:25,640 - INFO - ğŸ“‚ Real data: /home/matt/Dev/HOSER/hoser-distill-optuna-6/../data/BJUT_Beijing/test.csv
2025-11-03 17:43:25,640 - INFO - âš™ï¸  Config: config/abnormal_detection.yaml
2025-11-03 17:43:25,640 - INFO - ğŸ’¾ Output directory: abnormal/BJUT_Beijing/test/detection
2025-11-03 17:43:25,641 - INFO - âš™ï¸  Loading configuration...
2025-11-03 17:43:25,648 - INFO - ğŸ“‚ Loading road network...
2025-11-03 17:43:25,747 - INFO - ğŸ“‚ Loading real trajectories...
2025-11-03 17:43:27,278 - INFO - âœ… Loaded 5979 trajectories
2025-11-03 17:43:27,437 - INFO - ğŸ“Š Total trajectory points: 155,527
2025-11-03 17:43:27,437 - INFO - ğŸ”§ Initializing abnormal trajectory detector...
2025-11-03 17:43:31,902 - INFO - ğŸ” Running abnormality detection...
2025-11-03 17:43:31,902 - INFO - Analyzing 155527 trajectories for abnormalities...
2025-11-03 17:43:34,472 - INFO - Detection complete. Found abnormalities:
2025-11-03 17:43:34,472 - INFO -   speeding: 0 (0.00%)
2025-11-03 17:43:34,473 - INFO -   detour: 0 (0.00%)
2025-11-03 17:43:34,473 - INFO -   suspicious_stops: 0 (0.00%)
2025-11-03 17:43:34,473 - INFO -   circuitous: 0 (0.00%)
2025-11-03 17:43:34,473 - INFO -   unusual_duration: 0 (0.00%)
2025-11-03 17:43:34,473 - INFO - ğŸ’¾ Saving detection results...
2025-11-03 17:43:34,473 - INFO - âœ… Saved detection results to abnormal/BJUT_Beijing/test/detection/detection_results.json
2025-11-03 17:43:34,474 - INFO - âœ… Saved statistics to abnormal/BJUT_Beijing/test/detection/statistics_by_category.json
2025-11-03 17:43:34,475 - INFO - ğŸ’¾ Saving trajectory samples...
2025-11-03 17:43:34,475 - INFO - 
============================================================
2025-11-03 17:43:34,475 - INFO - ğŸ“‹ ABNORMAL TRAJECTORY DETECTION SUMMARY
2025-11-03 17:43:34,475 - INFO - ============================================================
2025-11-03 17:43:34,475 - INFO - Dataset: BJUT_Beijing
2025-11-03 17:43:34,475 - INFO - Total trajectories analyzed: 5,979
2025-11-03 17:43:34,476 - INFO - 
Abnormalities detected:
2025-11-03 17:43:34,476 - INFO -   â€¢ speeding: 0 (0.00%)
2025-11-03 17:43:34,476 - INFO -   â€¢ detour: 0 (0.00%)
2025-11-03 17:43:34,476 - INFO -   â€¢ suspicious_stops: 0 (0.00%)
2025-11-03 17:43:34,476 - INFO -   â€¢ circuitous: 0 (0.00%)
2025-11-03 17:43:34,476 - INFO -   â€¢ unusual_duration: 0 (0.00%)
2025-11-03 17:43:34,476 - INFO - ============================================================
2025-11-03 17:43:34,476 - INFO - ğŸ’¾ Results saved to: abnormal/BJUT_Beijing/test/detection
2025-11-03 17:43:34,476 - INFO - âœ… Analysis complete!
2025-11-03 17:43:34,524 - INFO -   âœ… Detection complete: 5 abnormal categories found
2025-11-03 17:43:34,525 - INFO - 
ğŸ“ˆ Step 2: Evaluating models on abnormal trajectories (test)...
2025-11-03 17:43:34,525 - INFO -   No abnormal trajectories found, skipping model evaluation
2025-11-03 17:43:34,525 - INFO - 
âœ… Abnormal trajectory detection complete! Results in abnormal/BJUT_Beijing/
2025-11-03 17:43:34,530 - INFO - âœ… Phase abnormal completed
2025-11-03 17:43:34,530 - INFO - â­ï¸  Skipping phase: scenarios
2025-11-03 17:43:34,530 - INFO - 
âœ… Pipeline completed successfully!
2025-11-03 17:43:34,530 - INFO - âœ… Pipeline completed successfully!
ğŸ“‚ Loading road network...
ğŸ“ Calculating road centroids for 87,481 roads...
âœ… Road network loaded: 87,481 valid roads
ğŸ“‚ Loading trajectories from /home/matt/Dev/HOSER/hoser-distill-optuna-6/../data/BJUT_Beijing/train.csv...
ğŸ”„ Parsing 27,897 trajectories...
âœ… Loaded 27,897 valid trajectories (dropped 0)
ğŸ“‚ Using cached road network...
ğŸ“‚ Loading trajectories from /home/matt/Dev/HOSER/hoser-distill-optuna-6/../data/BJUT_Beijing/test.csv...
ğŸ”„ Parsing 5,979 trajectories...
âœ… Loaded 5,979 valid trajectories (dropped 0)
